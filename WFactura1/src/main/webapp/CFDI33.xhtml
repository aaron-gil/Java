<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>CFDI 3.3</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <link href="webjars/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet"/>
        <!--<script src="webjars/jquery/3.3.1/jquery.min.js"></script>-->
        <script src="webjars/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    </h:head>
    <h:body>
        <ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                        template="template/plantilla.xhtml">
            <ui:define name="menuP"></ui:define>
            <ui:define name="contenido"></ui:define>
            <ui:define name="contenidoFull">
                <!--<p:messages id="messages" showDetail="true" closable="true">
                    <p:autoUpdate /> formcfdi33:growl
                </p:messages>-->

                <h:form id="formcfdi33">
                    <p:growl id="growl" showDetail="true" sticky="true" life="800">
                        <p:autoUpdate />
                    </p:growl>
                    <div class="accordion texto13" id="cfdi33">
                        <div class="card">
                            <div class="card-header" id="emisor">
                                <h2 class="mb-0">
                                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#emisorM" aria-expanded="true" aria-controls="emisorM">
                                        Emisor
                                    </button>
                                </h2>
                            </div>

                            <div id="emisorM" class="collapse show" aria-labelledby="emisor" data-parent="#cfdi33">
                                <div class="card-body">
                                    <div class="container-fluid">
                                        <p:outputPanel id="emisorPanel">
                                            <div class="row">
                                                <div class="col-md-3">
                                                    <h:outputText value="*RFC" />
                                                </div>                                                                                               
                                                <div class="col-md-3">
                                                    <h:outputText value="Razon Social" />
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="*Lugar de expedición" />
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="*Regimen fiscal" />
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-3">
                                                    <h:inputText value="#{cfdi33V.usuarioSeleccionado.nombre}" readonly="true" />
                                                </div> 
                                                <div class="col-md-3">
                                                    <h:inputText value="#{cfdi33V.usuarioSeleccionado.nombreCompleto}" readonly="true" />
                                                </div>
                                                <div class="col-md-3">
                                                    <h:inputText value="#{cfdi33V.usuarioSeleccionado.cp}" readonly="true" />
                                                </div>
                                                <div class="col-md-3">
                                                    <h:inputText value="#{cfdi33V.usuarioSeleccionado.regimenFiscal}" readonly="true"/>
                                                </div>
                                            </div>
                                            <br/>
                                            <div class="row">
                                                <div class="col-md-3">
                                                    <h:outputText value="*Tipo de documento" />
                                                </div>                                               
                                                <div class="col-md-3">
                                                    <h:outputText value="Serie" rendered="#{cfdi33V.renderSerie}" />
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="Folio" rendered="#{cfdi33V.renderSerie}" />
                                                </div>
                                                <div class="col-md-3">

                                                </div>
                                            </div>                                            
                                            <div class="row">                                                
                                                <div class="col-md-3">
                                                    <p:selectOneMenu value="#{cfdi33V.tipoComp}"  style="width: 200px !important">
                                                        <f:selectItem itemValue="" itemLabel="Seleccionar" />
                                                        <f:selectItems value="#{cfdi33V.listaTiposComprobante}" var="td" itemValue="#{td.identifica}" itemLabel="#{td.nombre}"/>
                                                        <p:ajax update="emisorPanel" listener="#{cfdi33V.seriesSelc}"></p:ajax>
                                                    </p:selectOneMenu>
                                                </div>                                                
                                                <div class="col-md-3">
                                                    <p:selectOneMenu value="#{cfdi33V.serieS}" style="width: 200px !important" rendered="#{cfdi33V.renderSerie}">
                                                        <f:selectItem itemValue="" itemLabel="Seleccionar" />
                                                        <f:selectItems value="#{cfdi33V.seriesSeleccionadas}" var="s" itemValue="#{s.identifica}" itemLabel="#{s.nombre}"/>
                                                        <p:ajax update="emisorPanel" listener="#{cfdi33V.folioSiguiente()}"></p:ajax>
                                                    </p:selectOneMenu>
                                                </div> 
                                                <div class="col-md-3" id="folio">
                                                    <h:inputText value="#{cfdi33V.nextFolio}" rendered="#{cfdi33V.renderSerie}" readonly="true"/>
                                                </div>
                                                <div class="col-md-3">
                                                    <p:selectBooleanCheckbox value="#{cfdi33V.checkRelacionados}" itemLabel="UUID Relacionado">
                                                        <f:ajax render=":formcfdi33" listener="#{cfdi33V.habilitarRelacionado}" />
                                                    </p:selectBooleanCheckbox>
                                                </div>
                                            </div>
                                            <br/>
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <p:selectBooleanCheckbox value="#{cfdi33V.checkComplementoSEP}" itemLabel="Complemento SEP">
                                                        <f:ajax render=":formcfdi33" listener="#{cfdi33V.habilitarSEP}" />
                                                    </p:selectBooleanCheckbox>
                                                </div>
                                                <div class="col-md-4">
                                                    <p:selectBooleanCheckbox value="#{cfdi33V.checkComplementoIL}" itemLabel="Complemento Impuestos Locales">
                                                        <f:ajax render=":formcfdi33" listener="#{cfdi33V.habilitarIpLoc}" />
                                                    </p:selectBooleanCheckbox>
                                                </div>
                                                <div class="col-md-4" >
                                                    <p:selectBooleanCheckbox value="#{cfdi33V.checkComplementoCE}" itemLabel="Complemento Comercio Exterior" rendered="false">
                                                        <f:ajax render=":formcfdi33" listener="#{cfdi33V.habilitarComExt}" />
                                                    </p:selectBooleanCheckbox>
                                                </div>
                                            </div>
                                        </p:outputPanel>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card" style="display: #{cfdi33V.strUUIDRel}">
                            <div class="card-header" id="relacionados">
                                <p:outputPanel id="uuidRB">
                                    <h6 class="mb-0">
                                        <button class="btn btn-link collapsed" id="focus"  type="button" data-toggle="collapse" 
                                                data-target="#relacionadosM" aria-expanded="false" aria-controls="relacionadosM" title="Opcional Para agregar UUID relacionado">
                                            UUID Relacionados 
                                        </button>                                   
                                    </h6>
                                </p:outputPanel>
                                <p:tooltip id="toolTipGrow" for="uuidRB" value="Nodo OPCIONAL para agregar UUID's relacionados."
                                           position="top"/>
                            </div>
                            <!--<p:tooltip id="toolTipFocus" for="relacionados" showEffect="clip" hideEffect="explode" position="left" />-->
                            <div id="relacionadosM" class="collapse" aria-labelledby="relacionados" data-parent="#cfdi33">
                                <div class="card-body">
                                    <div class="container-fluid">
                                        <p:outputPanel id="uuidRelacionado">        
                                            <p:outputPanel id="relacion">
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <h:outputText value="*Tipo Relación" />
                                                    </div>
                                                    <div class="col-md-4">
                                                        <h:outputText value="*UUID"/>
                                                    </div>
                                                </div>
                                                <div class="row">                                                    
                                                    <div class="col-md-3">
                                                        <p:selectOneMenu id="somTipoRelacion" style="width: 200px !important" value="#{cfdi33V.tipoRelacionS}" autoWidth="false" disabled="#{cfdi33V.relacionSelect}">
                                                            <f:selectItem itemValue="" itemLabel="Seleccionar" ></f:selectItem>
                                                            <f:selectItems value="#{cfdi33V.listaTiposRelacion}" var="t" itemValue="#{t.identifica}" itemLabel="#{t.descripcion}" ></f:selectItems>
                                                            <p:ajax event="change" listener="#{cfdi33V.tipoRel}" />
                                                        </p:selectOneMenu>
                                                    </div>                                                    
                                                    <div class="col-md-4">
                                                        <p:inputMask id="uiii" size="40" value="#{cfdi33V.uuidRela}" mask="********-****-****-****-************">  <!--[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}-->
                                                            <p:ajax event="blur" listener="#{cfdi33V.verif()}" update="uiii" />
                                                        </p:inputMask>
                                                    </div>
                                                    <div class="col-md-2">
                                                        <h:commandButton value="Agregar">
                                                            <p:ajax listener="#{cfdi33V.agregarRelacionado}" update="formcfdi33:relacion formcfdi33:dtUUIDRel"/>
                                                        </h:commandButton>
                                                    </div>
                                                </div>                                        
                                            </p:outputPanel>
                                            <br/>
                                            <p:outputPanel id="dtUUIDRel" >
                                                <p:dataTable rendered="#{cfdi33V.relacionTable}" value="#{cfdi33V.uuidRelacionados}"  var="c"
                                                             scrollable="true"  scrollHeight="250px" emptyMessage="No hay UUID's Relacionados">
                                                    <p:column headerText="UUID" >
                                                        <h:outputText value="#{c}" />
                                                    </p:column>
                                                    <p:column headerText="Eliminar" style="text-align: right">
                                                        <h:commandButton value = "Eliminar" >
                                                            <p:ajax listener="#{cfdi33V.eliminarRelacionado(c)}" update=":formcfdi33:uuidRelacionado"/>
                                                        </h:commandButton>
                                                    </p:column>
                                                </p:dataTable>
                                            </p:outputPanel>
                                        </p:outputPanel>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header" id="receptor">
                                <h2 class="mb-0">
                                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#receptorM" aria-expanded="false" aria-controls="receptorM">
                                        Receptor
                                    </button>
                                </h2>
                            </div>
                            <div id="receptorM" class="collapse" aria-labelledby="receptor" data-parent="#cfdi33">
                                <div class="card-body">
                                    <div class="container-fluid">
                                        <p:outputPanel id="receptorPanel">
                                            <div class="row"> 
                                                <div class="col-md-3">
                                                    <h:outputText value="Buscar RFC receptor" />
                                                </div>
                                            </div>
                                            <div class="row">                                                
                                                <div class="col-md-12">
                                                    <p:autoComplete id="clie" value="#{cfdi33V.clienteString}" completeMethod="#{cfdi33V.completeCliente}" forceSelection="true" scrollHeight="250" >
                                                        <p:ajax event="itemSelect" update="receptorPanel" listener="#{cfdi33V.compClienSet }"></p:ajax>
                                                    </p:autoComplete>
                                                </div>                                            
                                            </div>
                                            <br/>
                                            <div class="row">
                                                <div class="col-md-3">
                                                    <h:outputText value="Cliente:" />
                                                </div> 
                                                <div class="col-md-3">
                                                    <h:outputText value="*RFC: " />
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="Razon Social:" />
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="Recidencia fiscal: " />
                                                </div>
                                            </div>
                                            <div class="row">

                                                <div class="col-md-3">
                                                    <h:outputText value="#{cfdi33V.cliente.nombre}" />
                                                </div>

                                                <div class="col-md-3">
                                                    <h:outputText value="#{cfdi33V.cliente.rfc}" />
                                                </div>

                                                <div class="col-md-3">
                                                    <h:outputText value="#{cfdi33V.cliente.razonSocial}" />
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="#{cfdi33V.cliente.cp}" />
                                                </div>
                                            </div>
                                            <br/>
                                            <div class="row">
                                                <div class="col-md-5">
                                                    <h:outputText value="*Uso CFDI:" />
                                                </div>

                                            </div>
                                            <div class="row">                                                
                                                <div class="col-md-5">
                                                    <p:autoComplete id="uso" value="#{cfdi33V.usoCfdiBean}" completeMethod="#{cfdi33V.completeUso}" scrollHeight="250"
                                                                    var="us" itemValue="#{us}" itemLabel="#{us.descripcion}"  converter="usoCfdiConverter" forceSelection="true" >
                                                        <p:column>
                                                            <h:outputText value="#{us.identifica}" />
                                                        </p:column>
                                                        <p:column>
                                                            <h:outputText value="#{us.descripcion}" />
                                                        </p:column>
                                                        <p:ajax event="itemSelect" update="formcfdi33:receptorPanel"></p:ajax>
                                                    </p:autoComplete>
                                                </div>                                             

                                            </div>
                                        </p:outputPanel>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header" id="pago">
                                <h2 class="mb-0">
                                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#pagoM" aria-expanded="false" aria-controls="pagoM">
                                        Forma de pago
                                    </button>
                                </h2>
                            </div>
                            <div id="pagoM" class="collapse" aria-labelledby="pago" data-parent="#cfdi33">
                                <div class="card-body">
                                    <div class="container-fluid">
                                        <p:outputPanel id="pagoPanel">
                                            <div class="row">
                                                <div class="col-md-3">
                                                    <h:outputText value="*Moneda:" />
                                                </div> 
                                                <div class="col-md-3">
                                                    <h:outputText value="Forma de Pago: " />
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="Método de Pago: " />
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-3">
                                                    <p:selectOneMenu style="width: 200px !important" value="#{cfdi33V.monedaS}">                                                        
                                                        <f:selectItems	value="#{cfdi33V.listaMonedas}" var="m" itemValue="#{m.identifica}" itemLabel="#{m.identifica}"></f:selectItems>  4
                                                        <f:ajax event="itemSelect" render=":formcfdi33:pagoPanel" listener="#{cfdi33V.monedaM}" />
                                                    </p:selectOneMenu>
                                                </div>                                                
                                                <div class="col-md-3">
                                                    <p:selectOneMenu style="width: 200px !important" value="#{cfdi33V.formaPagoS}" disabled="false">
                                                        <f:selectItem itemValue="" itemLabel="Seleccionar una opción"></f:selectItem>
                                                        <f:selectItems value="#{cfdi33V.listaFormasPago}" var="m" itemValue="#{m.identifica}" itemLabel="#{m.descripcion}"></f:selectItems>
                                                        <p:ajax event="itemSelect" listener="#{cfdi33V.formPag}" />
                                                    </p:selectOneMenu>
                                                </div>                                                
                                                <div class="col-md-3">
                                                    <p:selectOneMenu style="width: 200px !important" value="#{cfdi33V.metodoPagoS}">
                                                        <f:selectItem itemValue="" itemLabel="Seleccionar"></f:selectItem>
                                                        <f:selectItems value="#{cfdi33V.listaMetodosPago}" var="m" itemValue="#{m.identifica}" itemLabel="#{m.descripcion}"></f:selectItems>
                                                        <p:ajax event="itemSelect" listener="#{cfdi33V.metodoP}"/>
                                                    </p:selectOneMenu>
                                                </div>

                                            </div>
                                            <br/>
                                            <div class="row">
                                                <div class="col-md-3">
                                                    <h:outputText value="*Tipo de cambio:" />
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="Condiciones de pago:" />
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-3">
                                                    <p:inputNumber value="#{cfdi33V.tipoCambio}" id="tipoCambioIn" decimalPlaces="6" minValue="0" disabled="#{cfdi33V.tipoCambioBool}" >
                                                        <f:ajax listener="#{cfdi33V.tipoCambioSet}" event="blur" render=":formcfdi33:pagoPanel  :formcfdi33:totalPanel"/>
                                                    </p:inputNumber>
                                                </div>

                                                <div class="col-md-3">
                                                    <h:inputText value="#{cfdi33V.condicionesPago}">
                                                        <p:ajax event="blur" listener="#{cfdi33V.condicionesP()}" />
                                                    </h:inputText>
                                                </div>
                                            </div>
                                        </p:outputPanel>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header" id="conc">
                                <h2 class="mb-0">
                                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#concM" aria-expanded="false" aria-controls="concM">
                                        Conceptos
                                    </button>
                                </h2>
                            </div>
                            <div id="concM" class="collapse" aria-labelledby="conc" data-parent="#cfdi33">
                                <div class="card-body">
                                    <p:outputPanel id="conceptosPanel">
                                        <div class="row">
                                            <div class="col-md-2 text-right">
                                                <h:outputText value="Buscar producto: " />
                                            </div>
                                            <div class="col-md-6 text-left">
                                                <p:autoComplete id="producto" value="#{cfdi33V.productoString}" completeMethod="#{cfdi33V.completeProducto}" forceSelection="true" scrollHeight="300" >
                                                    <p:ajax event="itemSelect" update="conceptosPanel" listener="#{cfdi33V.compProdSet}"></p:ajax>
                                                </p:autoComplete>
                                            </div>
                                        </div>
                                        <br/>
                                        <div class="row">                                        
                                            <div class="col-md-6">                                                
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="*Clave Producto/Servicio: " />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:outputText value="#{cfdi33V.producto.codigoSat}" />
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="Descripción P/S: " />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:outputText value="#{cfdi33V.producto.descripcion}" />
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="*Clave unidad: " />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:outputText value="#{cfdi33V.producto.medida.identifica}" />
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="Descripción:" />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:inputText value="#{cfdi33V.descripcionProducto}" maxlength="1000" >
                                                            <f:ajax event="blur" listener="#{cfdi33V.descripcionProductoSet}" render="@this" />
                                                        </h:inputText>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="No. Predial: " />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:outputText value="#{cfdi33V.producto.numeroPredial}" />
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="No. Identificador: " />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:outputText value="#{cfdi33V.producto.numeroIdentificador}" />
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="col-md-6">                                                
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="*Cantidad: " />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:inputText value="#{cfdi33V.cantidad}" readonly="#{cfdi33V.inputCon}">
                                                            <f:ajax event="blur" render="conceptosPanel" listener="#{cfdi33V.cantidadXvalor}" />
                                                        </h:inputText>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="*Valor unitario: " />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:inputText value="#{cfdi33V.valorUnitarioB}" readonly="#{cfdi33V.inputCon}" >
                                                            <f:convertNumber groupingUsed="true"  maxFractionDigits="6" type="currency" locale="es_MX" />
                                                            <f:ajax event="blur" render="conceptosPanel" listener="#{cfdi33V.cantidadXvalor}" />
                                                        </h:inputText>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="*Importe: " />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:outputText value="#{cfdi33V.importe}">
                                                            <f:convertNumber currencySymbol="$" groupingUsed="true"  maxFractionDigits="6" type="currency" locale="es_MX" />
                                                        </h:outputText>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="Porcentaje descuento: " />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:inputText value="#{cfdi33V.porcentajeDes}" readonly="#{cfdi33V.inputCon}">
                                                            <p:ajax event="keyup" update="conceptosPanel" listener="#{cfdi33V.descuentoProd}" />
                                                        </h:inputText>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="Descuento: " />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:outputText value="#{cfdi33V.descuento}">
                                                            <f:convertNumber currencySymbol="$" groupingUsed="true"  maxFractionDigits="6" type="currency" locale="es_MX" />
                                                        </h:outputText>
                                                    </div>
                                                </div>
                                            </div>                                      
                                        </div>
                                        <div class="row">
                                            <div class="col-md-3 text-right">
                                                <h:outputText value="No. Pedimento: " />
                                            </div>
                                            <div class="col-md-9 text-left">
                                                <h:outputText value="#{cfdi33V.producto.npedimento}" />
                                            </div>
                                        </div>
                                        <br/>    
                                        <div class="row">
                                            <div class="col-md-12 text-left">
                                                <p:selectBooleanCheckbox itemLabel="Impuestos Trasladados" value="#{cfdi33V.checktrasladados}" rendered="#{cfdi33V.activChecksImp}">
                                                    <p:ajax update=":formcfdi33:panelTrasl" listener="#{cfdi33V.agregarVTrasladados()}" />
                                                </p:selectBooleanCheckbox>
                                            </div>
                                        </div>
                                        <p:outputPanel id="panelTrasl">
                                            <p:outputPanel style="border-style: dashed; border-color: rgb(244,129,16); padding: 5px; margin-bottom: 7px;" rendered="#{cfdi33V.checktrasladados}" >

                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <h:outputText value="Base: " rendered="#{cfdi33V.checktrasladados}" />
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Impuesto:  " rendered="#{cfdi33V.checktrasladados}"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Tipo Factor:  " rendered="#{cfdi33V.checktrasladados}" />
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Tasa o Cuota:  " rendered="#{cfdi33V.checktrasladados}"/>
                                                    </div>
                                                    <div class="col-md-1">
                                                        <h:outputText value="Importe:  " rendered="#{cfdi33V.checktrasladados}"/>
                                                    </div>
                                                </div>
                                                <div class="row" >

                                                    <div class="col-md-2">
                                                        <h:inputText value="#{cfdi33V.baseT}" rendered="#{cfdi33V.checktrasladados}" readonly="true" />
                                                    </div>

                                                    <div class="col-md-3">
                                                        <p:selectOneMenu style="width: 200px !important" value="#{cfdi33V.ivaT}" disabled="false" rendered="#{cfdi33V.checktrasladados}" >
                                                            <f:selectItem itemValue="" itemLabel="Seleccionar"></f:selectItem>
                                                            <f:selectItem itemValue="iva" itemLabel="IVA"></f:selectItem>
                                                            <f:selectItem itemValue="ieps" itemLabel="IEPS"></f:selectItem>
                                                            <p:ajax event="itemSelect" update=":formcfdi33:panelTrasl" listener="#{cfdi33V.activTipFacTra}"></p:ajax>
                                                        </p:selectOneMenu>
                                                    </div>

                                                    <div class="col-md-3">
                                                        <p:selectOneMenu style="width: 200px !important" id="tipFT" value="#{cfdi33V.tipoFactorT}" rendered="#{cfdi33V.checktrasladados}" disabled="#{cfdi33V.tipoFactorTActiv}">
                                                            <f:selectItem itemValue="" itemLabel="Seleccionar"></f:selectItem>
                                                            <f:selectItems value="#{cfdi33V.tipoFactorTL}" var="tf" itemLabel="#{tf}" itemValue="#{tf}" />
                                                            <p:ajax event="itemSelect" update=":formcfdi33:panelTrasl" listener="#{cfdi33V.tasaOCuotaTraList}"></p:ajax>
                                                        </p:selectOneMenu>
                                                    </div>   
                                                    <div class="col-md-3">
                                                        <p:selectOneMenu style="width: 200px !important" id="tasCT" value="#{cfdi33V.tasaOCuotaT}" rendered="#{cfdi33V.checktrasladados}" disabled="#{cfdi33V.tipoTasaOCTActiv}">
                                                            <f:selectItem itemValue="" itemLabel="Seleccionar"></f:selectItem>
                                                            <f:selectItems value="#{cfdi33V.listTCTras}"/>
                                                            <p:ajax event="itemSelect" update=":formcfdi33:panelTrasl" listener="#{cfdi33V.calcularImpuestosTrasladados}"></p:ajax>
                                                        </p:selectOneMenu>
                                                    </div> 

                                                    <div class="col-md-1">
                                                        <h:outputText id="impotT" value="#{cfdi33V.importeT}" rendered="#{cfdi33V.checktrasladados}" >
                                                            <f:convertNumber currencySymbol="$" groupingUsed="true"  maxFractionDigits="6" type="currency" locale="es_MX" />
                                                        </h:outputText>
                                                    </div> 
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-12 text-right">
                                                        <h:commandButton value="Agregar Traslado" rendered="#{cfdi33V.btnAgrTra}" >
                                                            <p:ajax listener="#{cfdi33V.agregarImpTras}" update="formcfdi33:impTrasladadosTable formcfdi33:panelTrasl" ></p:ajax>
                                                        </h:commandButton>
                                                    </div>
                                                </div>
                                                <br/>
                                                <p:outputPanel id="impTrasladadosPanel" >
                                                    <p:dataTable var="impTras" value="#{cfdi33V.listTras}" id="impTrasladadosTable" rendered="#{cfdi33V.impTraPan}">
                                                        <p:column headerText="Base" class="texto13">
                                                            <h:outputText value="#{impTras.base}" />
                                                        </p:column>
                                                        <p:column headerText="Impuesto" class="texto13">
                                                            <h:outputText value="#{impTras.iva}" />
                                                        </p:column>                                                    
                                                        <p:column headerText="T Factor" class="texto13">
                                                            <h:outputText value="#{impTras.tipoFactor}" />
                                                        </p:column>
                                                        <p:column headerText="TasaOCuota" class="texto13">
                                                            <h:outputText value="#{impTras.tasaOCuota}" />
                                                        </p:column>
                                                        <p:column headerText="Moneda" class="texto13">
                                                            <h:outputText value="#{impTras.moneda}" />
                                                        </p:column>
                                                        <p:column headerText="T Cambio" class="texto13">
                                                            <h:outputText value="#{impTras.tipoCambio}" />
                                                        </p:column>
                                                        <p:column headerText="Importe" class="texto13">
                                                            <h:outputText value="#{impTras.importe}" />
                                                        </p:column>
                                                        <p:column headerText="Opción" class="texto13" >
                                                            <div class="text-right">
                                                                <h:commandButton value="Eliminar">
                                                                    <p:ajax listener="#{cfdi33V.eliminarImpTra(impTras)}" update="formcfdi33:impTrasladadosTable formcfdi33:impTrasladadosPanel" ></p:ajax>
                                                                </h:commandButton>
                                                            </div>
                                                        </p:column>
                                                    </p:dataTable>
                                                </p:outputPanel>
                                            </p:outputPanel>
                                        </p:outputPanel>
                                        <br/>
                                        <div class="row">
                                            <div class="col-md-12 text-left">
                                                <p:selectBooleanCheckbox itemLabel="Impuestos Retenidos" value="#{cfdi33V.checkRetenidos}"  rendered="#{cfdi33V.activChecksImp}">  
                                                    <p:ajax update=":formcfdi33:panelReten" listener="#{cfdi33V.agregarVRetenciones()}" />
                                                </p:selectBooleanCheckbox>                                                
                                            </div>
                                        </div>

                                        <p:outputPanel id="panelReten">
                                            <p:outputPanel style="border-style: dashed; border-color: rgb(244,129,16); padding: 5px; margin-bottom: 7px;" rendered="#{cfdi33V.checkRetenidos}" >
                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <h:outputText value="Base: " rendered="#{cfdi33V.checkRetenidos}" />
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Impuesto:  " rendered="#{cfdi33V.checkRetenidos}"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Tipo Factor:  " rendered="#{cfdi33V.checkRetenidos}" />
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Tasa o Cuota:  " rendered="#{cfdi33V.checkRetenidos}"/>
                                                    </div>
                                                    <div class="col-md-1">
                                                        <h:outputText value="Importe:  " rendered="#{cfdi33V.checkRetenidos}"/>
                                                    </div>
                                                </div>
                                                <div class="row" >                                                    
                                                    <div class="col-md-2">
                                                        <h:inputText value="#{cfdi33V.baseR}" rendered="#{cfdi33V.checkRetenidos}" readonly="true"/>
                                                    </div>                                                    
                                                    <div class="col-md-3">
                                                        <p:selectOneMenu style="width: 200px !important" value="#{cfdi33V.ivaR}" disabled="false" rendered="#{cfdi33V.checkRetenidos}" >
                                                            <f:selectItem itemValue="" itemLabel="Seleccionar"></f:selectItem>
                                                            <f:selectItem itemValue="iva" itemLabel="IVA"></f:selectItem>
                                                            <f:selectItem itemValue="ieps" itemLabel="IEPS"></f:selectItem>
                                                            <f:selectItem itemValue="isr" itemLabel="ISR"></f:selectItem>
                                                            <p:ajax event="itemSelect" update=":formcfdi33:panelReten" listener="#{cfdi33V.activTipFacRet}"></p:ajax>
                                                        </p:selectOneMenu>
                                                    </div>                                                    
                                                    <div class="col-md-3">
                                                        <p:selectOneMenu style="width: 200px !important" id="tipFR" value="#{cfdi33V.tipoFactorR}" rendered="#{cfdi33V.checkRetenidos}" disabled="#{cfdi33V.tipoFactorRActiv}">
                                                            <f:selectItem itemValue="" itemLabel="Seleccionar"></f:selectItem>
                                                            <f:selectItems value="#{cfdi33V.tipoFactorRL}" var="tf" itemLabel="#{tf}" itemValue="#{tf}" />
                                                            <p:ajax event="itemSelect" update=":formcfdi33:panelReten" listener="#{cfdi33V.tasaOCuotaRetList}"></p:ajax>
                                                        </p:selectOneMenu>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:selectOneMenu style="width: 200px !important" id="tasCR" value="#{cfdi33V.tasaOCuotaR}" rendered="#{cfdi33V.checkRetenidos}" disabled="#{cfdi33V.tipoTasaOCRActiv}">
                                                            <f:selectItem itemValue="" itemLabel="Seleccionar"></f:selectItem>
                                                            <f:selectItems value="#{cfdi33V.listTCReten}"/>
                                                            <p:ajax event="itemSelect" update=":formcfdi33:panelReten" listener="#{cfdi33V.calcularImpuestosRetenidos}"></p:ajax>
                                                        </p:selectOneMenu>
                                                    </div>
                                                    <div class="col-md-1">
                                                        <h:outputText id="impotR" value="#{cfdi33V.importeR}" rendered="#{cfdi33V.checkRetenidos}" >
                                                            <f:convertNumber currencySymbol="$" groupingUsed="true"  maxFractionDigits="6" type="currency" locale="es_MX" />
                                                        </h:outputText>
                                                    </div> 
                                                </div>
                                                <div class="row">                                     
                                                    <div class="col-md-12 text-right">
                                                        <h:commandButton value="Agregar Retenido" rendered="#{cfdi33V.btnAgrRet}" >
                                                            <p:ajax listener="#{cfdi33V.agregarImpRete}" update="formcfdi33:impRetenidosTable formcfdi33:panelReten" ></p:ajax>
                                                        </h:commandButton>
                                                    </div>
                                                </div>
                                                <br/>
                                                <p:outputPanel id="impRetenidosPanel" style="margin-top: 5px">
                                                    <p:dataTable var="impRet" value="#{cfdi33V.listRete}" id="impRetenidosTable" rendered="#{cfdi33V.impRetPan}">
                                                        <p:column headerText="Base" class="texto13">
                                                            <h:outputText value="#{impRet.base}" />
                                                        </p:column>
                                                        <p:column headerText="Impuesto" class="texto13">
                                                            <h:outputText value="#{impRet.iva}" />
                                                        </p:column>
                                                        <p:column headerText="T Factor" class="texto13">
                                                            <h:outputText value="#{impRet.tipoFactor}" />
                                                        </p:column>
                                                        <p:column headerText="TasaOCuota" class="texto13">
                                                            <h:outputText value="#{impRet.tasaOCuota}" />
                                                        </p:column>
                                                        <p:column headerText="Importe" class="texto13">
                                                            <h:outputText value="#{impRet.importe}" />
                                                        </p:column>
                                                        <p:column headerText="Moneda" class="texto13">
                                                            <h:outputText value="#{impRet.moneda}" />
                                                        </p:column>
                                                        <p:column headerText="T Cambio" class="texto13">
                                                            <h:outputText value="#{impRet.tipoCambio}" />
                                                        </p:column>
                                                        <p:column headerText="Opción" class="texto13">
                                                            <div class="text-right">
                                                                <h:commandButton value="Eliminar">
                                                                    <p:ajax listener="#{cfdi33V.eliminarImpRet(impRet)}" update="formcfdi33:impRetenidosTable formcfdi33:impRetenidosPanel" ></p:ajax>
                                                                </h:commandButton>
                                                            </div>
                                                        </p:column>
                                                    </p:dataTable>
                                                </p:outputPanel>
                                            </p:outputPanel>
                                        </p:outputPanel>
                                        <div class="row">
                                            <div class="col-md-5 text-right">
                                                <h:outputText value="" />
                                            </div>
                                            <div class="col-md-7 text-right">
                                                <h:commandButton value="Agregar Concepto" disabled="#{cfdi33V.btnAgrCon}">
                                                    <p:ajax listener="#{cfdi33V.agregarConcepto}" update="formcfdi33:listaConceptosPanel formcfdi33:listaConceptosTable formcfdi33:conceptosPanel formcfdi33:totalPanel :botones"></p:ajax>
                                                </h:commandButton>
                                            </div>
                                        </div>
                                    </p:outputPanel>
                                    <br/>
                                    <p:outputPanel id="listaConceptosPanel" style="margin-top: 20px">
                                        <p:outputPanel style="border-style: dashed; border-color: rgb(244,129,16); padding: 5px; margin-bottom: 7px;" rendered="#{cfdi33V.conceptosTableActv}" >

                                            <p:dataTable var="conc" value="#{cfdi33V.conceptos}" id="listaConceptosTable" rendered="#{cfdi33V.conceptosTableActv}">
                                                <f:facet name="header">
                                                    <h:outputText value="Conceptos agregados (Moneda:  #{cfdi33V.monedaS} TipoCambio:  #{cfdi33V.tipoCambio} )"/>
                                                </f:facet>
                                                <p:column headerText="Cod. SAT" class="texto13">
                                                    <h:outputText value="#{conc.producto.codigoSat}" />
                                                </p:column>
                                                <p:column headerText="Producto" class="texto13">
                                                    <h:outputText value="#{conc.producto.descripcion}" />
                                                </p:column>
                                                <p:column headerText="Cantidad" class="texto13">
                                                    <h:outputText value="#{conc.cantidad}" />
                                                </p:column>
                                                <p:column headerText="Descuento" class="texto13">
                                                    <h:outputText value="#{conc.descuento}" >
                                                        <f:convertNumber currencySymbol="$" groupingUsed="true"  maxFractionDigits="2" type="currency" locale="es_MX" />
                                                    </h:outputText>
                                                </p:column>
                                                <p:column headerText="Importe" class="texto13">
                                                    <h:outputText value="#{conc.importe}" >
                                                        <f:convertNumber currencySymbol="$" groupingUsed="true"  maxFractionDigits="2" type="currency" locale="es_MX" />
                                                    </h:outputText>
                                                </p:column>
                                                <p:column headerText="Eliminar" class="texto13">
                                                    <h:commandButton value="Eliminar" >
                                                        <p:ajax listener="#{cfdi33V.eliminarConcepto(conc)}" update="formcfdi33:listaConceptosPanel formcfdi33:listaConceptosTable formcfdi33:totalPanel :botones"></p:ajax>
                                                    </h:commandButton>
                                                </p:column>
                                            </p:dataTable>
                                        </p:outputPanel>
                                    </p:outputPanel>
                                </div>
                            </div>
                        </div>
                        <div class="card" style="display: #{cfdi33V.strComplementoSEP}">
                            <div class="card-header" id="sep">
                                <h2 class="mb-0">
                                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#sepM" aria-expanded="false" aria-controls="sepM">
                                        Complemento SEP
                                    </button>
                                </h2>
                            </div>
                            <div id="sepM" class="collapse" aria-labelledby="sep" data-parent="#cfdi33">
                                <div class="card-body">
                                    <p:outputPanel id="sepPanel">
                                        <p:outputPanel>
                                            <div class="row">
                                                <div class="col-md-3">
                                                    <h:outputText value="CURP"/>
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="Nombre Alumno" />
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="autRVOE" />
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="Nivel Educativo"/>
                                                </div>

                                            </div>
                                            <div class="row">                                                
                                                <div class="col-md-3">
                                                    <p:inputText value="#{cfdi33V.CURP}" maxlength="18">
                                                        <f:ajax event="blur" render="formcfdi33:sepPanel" listener="#{cfdi33V.activarAlum}"  />
                                                    </p:inputText>
                                                </div>                                                
                                                <div class="col-md-3">
                                                    <h:inputText value="#{cfdi33V.alumno}" disabled="#{cfdi33V.renderAlu}">
                                                        <f:ajax event="blur" render="formcfdi33:sepPanel" listener="#{cfdi33V.activarAutRVOE}" />
                                                    </h:inputText>
                                                </div>                                                
                                                <div class="col-md-3">
                                                    <h:inputText value="#{cfdi33V.autRVOE}" disabled="#{cfdi33V.renderAut}">
                                                        <f:ajax event="blur" render="formcfdi33:sepPanel" listener="#{cfdi33V.activarNEduc}" />
                                                    </h:inputText>
                                                </div>
                                                <div class="col-md-3">
                                                    <p:selectOneMenu style="width: 200px !important" value="#{cfdi33V.nivelEduc}" disabled="#{cfdi33V.renderNEdu}">
                                                        <f:selectItem itemLabel="Seleccione" itemValue="" noSelectionOption="true" />
                                                        <f:selectItem itemLabel="Preescolar" itemValue="Preescolar" />
                                                        <f:selectItem itemLabel="Primaria" itemValue="Primaria" />
                                                        <f:selectItem itemLabel="Secundaria" itemValue="Secundaria" />
                                                        <f:selectItem itemLabel="Profesional tecnico" itemValue="Profesional tecnico" />
                                                        <f:selectItem itemLabel="Bachillerato o su equivalente" itemValue="Bachillerato o su equivalente" />
                                                        <p:ajax event="itemSelect" update="formcfdi33:sepPanel" listener="#{cfdi33V.activarRfc}"/>
                                                    </p:selectOneMenu>
                                                </div> 

                                            </div>
                                            <br/>
                                            <div class="row">
                                                <div class="col-md-2">
                                                    <h:outputText value="RFC" />
                                                </div>
                                            </div>
                                            <div class="row">                                                
                                                <div class="col-md-2">
                                                    <h:inputText value="#{cfdi33V.RFCAl}" disabled="#{cfdi33V.renderRfc}" maxlength="13">
                                                        <f:ajax event="blur" render="formcfdi33:sepPanel" listener="#{cfdi33V.sepRFC}" />
                                                    </h:inputText>
                                                </div>
                                            </div>
                                        </p:outputPanel>
                                    </p:outputPanel>
                                </div>
                            </div>
                        </div>
                        <div class="card" style="display: #{cfdi33V.strComplementoIL}" >
                            <div class="card-header" id="CIL">
                                <h2 class="mb-0">
                                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#CILM" aria-expanded="false" aria-controls="CILM">
                                        Complemento Impuestos Locales
                                    </button>
                                </h2>
                            </div>
                            <div id="CILM" class="collapse" aria-labelledby="CIL" data-parent="#cfdi33">
                                <div class="card-body">
                                    <p:outputPanel id="CILPanel">                                        
                                        Trasladados Locales
                                        <p:outputPanel id="CILPanelT" style="border-style: dashed; border-color: rgb(244,129,16); padding: 5px; margin-bottom: 7px;">
                                            <div class="row">
                                                <div class="col-md-3">
                                                    <h:outputText value="*Descripción"/> 
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="*%TASA"/> 
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="*Importe"/>
                                                </div>
                                                <div class="col-md-3">

                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-3">                                                                                          
                                                    <p:inputText value="#{cfdi33V.decripCompImpLocTra}" >
                                                        <f:ajax event="blur" render="formcfdi33:CILPanel" listener="#{cfdi33V.habilitarRenderILCTT}" />
                                                    </p:inputText>
                                                </div> 
                                                <div class="col-md-3">                                                                                                   
                                                    <p:inputNumber value="#{cfdi33V.tasaCompImpLocTra}" style="max-width:50px !important" readonly="#{cfdi33V.renderILCTT}"  maxValue="200" decimalPlaces="0">
                                                        <f:ajax event="blur" render="formcfdi33:CILPanel" listener="#{cfdi33V.habilitarRenderILCTI}" />
                                                    </p:inputNumber>
                                                </div> 
                                                <div class="col-md-3">                                                    
                                                    <p:inputNumber value="#{cfdi33V.importeCompImpLocTra}" style="width:100px" readonly="#{cfdi33V.renderILCTI}"  decimalPlaces="6">
                                                        <f:ajax event="blur" render="formcfdi33:CILPanel" listener="#{cfdi33V.habilitarRenderILCTB}" />
                                                    </p:inputNumber>
                                                </div> 
                                                <div class="col-md-3">
                                                    <h:commandButton value="Agregar"  readonly="#{cfdi33V.renderILCTB}" >
                                                        <f:ajax render="formcfdi33:CILPanel formcfdi33:CILTableT formcfdi33:totalPanel" listener="#{cfdi33V.agregarILCT()}"/>
                                                    </h:commandButton>
                                                </div> 
                                            </div>
                                            <br/>
                                            <p:outputPanel id="CILTableT">
                                                <p:dataTable var="ILRT" value="#{cfdi33V.listILCT}" id="listaCILTTTable" rendered="#{cfdi33V.renderILCTTable}">
                                                    <f:facet name="header">
                                                        <h:outputText value="Impuestos agregados"/>
                                                    </f:facet>
                                                    <p:column headerText="Descripción" class="texto13">
                                                        <h:outputText value="#{ILRT.descripcion}" />
                                                    </p:column>
                                                    <p:column headerText="Tasa" class="texto13">
                                                        <h:outputText value="#{ILRT.porcentaje}" />
                                                    </p:column>
                                                    <p:column headerText="Importe" class="texto13">
                                                        <h:outputText value="#{ILRT.importe}" />
                                                    </p:column>
                                                    <p:column headerText="Opción" class="texto13">
                                                        <h:commandButton value="Eliminar" >
                                                            <p:ajax update="formcfdi33:CILPanel formcfdi33:CILTableT formcfdi33:totalPanel" listener="#{cfdi33V.eliminarILCT(ILRT)}"></p:ajax>
                                                        </h:commandButton>
                                                    </p:column>
                                                </p:dataTable>
                                            </p:outputPanel>
                                        </p:outputPanel>
                                        Retenciones Locales
                                        <p:outputPanel id="CILPanelR" style="border-style: dashed; border-color: rgb(244,129,16); padding: 5px; margin-bottom: 7px;">
                                            <div class="row">
                                                <div class="col-md-3">
                                                    <h:outputText value="*Descripción"/>  
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="*%TASA" />
                                                </div>
                                                <div class="col-md-3">
                                                    <h:outputText value="*Importe" />
                                                </div>
                                                <div class="col-md-3">

                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-3">                                                                                         
                                                    <p:inputText value="#{cfdi33V.decripCompImpLocRet}" >
                                                        <f:ajax event="blur" render="formcfdi33:CILPanel" listener="#{cfdi33V.habilitarRenderILCRT}" />
                                                    </p:inputText>
                                                </div> 
                                                <div class="col-md-3">                                                                                                    
                                                    <p:inputNumber value="#{cfdi33V.tasaCompImpLocRet}" style="max-width:50px !important" readonly="#{cfdi33V.renderILCRT}"  maxValue="200" decimalPlaces="0">
                                                        <f:ajax event="blur" render="formcfdi33:CILPanel" listener="#{cfdi33V.habilitarRenderILCRI}" />
                                                    </p:inputNumber>
                                                </div> 
                                                <div class="col-md-3">                                                    
                                                    <p:inputNumber value="#{cfdi33V.importeCompImpLocRet}" style="width:100px" readonly="#{cfdi33V.renderILCRI}" decimalPlaces="6">
                                                        <f:ajax event="blur" render="formcfdi33:CILPanel" listener="#{cfdi33V.habilitarRenderILCRB}" />
                                                    </p:inputNumber>
                                                </div> 
                                                <div class="col-md-3">
                                                    <h:commandButton value="Agregar"  readonly="#{cfdi33V.renderILCRB}" >
                                                        <f:ajax render="formcfdi33:CILPanel formcfdi33:CILTableR formcfdi33:totalPanel" listener="#{cfdi33V.agregarILCR()}"/>
                                                    </h:commandButton>
                                                </div> 
                                            </div>
                                            <br/>
                                            <p:outputPanel id="CILTableR">
                                                <p:dataTable var="ILRT" value="#{cfdi33V.listILCR}" id="listaCILTRTable" rendered="#{cfdi33V.renderILCRTable}">
                                                    <f:facet name="header">
                                                        <h:outputText value="Impuestos agregados"/>
                                                    </f:facet>
                                                    <p:column headerText="Descripción" class="texto13">
                                                        <h:outputText value="#{ILRT.descripcion}" />
                                                    </p:column>
                                                    <p:column headerText="Tasa" class="texto13">
                                                        <h:outputText value="#{ILRT.porcentaje}" />
                                                    </p:column>
                                                    <p:column headerText="Importe" class="texto13">
                                                        <h:outputText value="#{ILRT.importe}" />
                                                    </p:column>
                                                    <p:column headerText="Opción" class="texto13">
                                                        <h:commandButton value="Eliminar" >
                                                            <p:ajax update="formcfdi33:CILPanel formcfdi33:CILTableR formcfdi33:totalPanel" listener="#{cfdi33V.eliminarILCR(ILRT)}"></p:ajax>
                                                        </h:commandButton>
                                                    </p:column>
                                                </p:dataTable>
                                            </p:outputPanel>
                                        </p:outputPanel>
                                    </p:outputPanel>
                                </div>
                            </div>
                        </div>

                        <p:outputPanel rendered="false">

                            <div class="card" style="display: #{cfdi33V.strComplementoCE}">
                                <div class="card-header" id="CCE">
                                    <h2 class="mb-0">
                                        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#CCEM" aria-expanded="false" aria-controls="CCEM">
                                            Complemento Comercio Exterior
                                        </button>
                                    </h2>
                                </div>
                                <div id="CCEM" class="collapse" aria-labelledby="CCE" data-parent="#cfdi33">
                                    <div class="card-body">
                                        <p:outputPanel id="datosGenerales">
                                            <div class="row">
                                                <div class="col-md-3">
                                                    <h:outputText value="NumRegIdTrib:" />
                                                </div>
                                                <div class="col-md-3">
                                                    <h:inputText  value="#{cfdi33V.numRegIdTrib}" />
                                                </div>
                                            </div>
                                            <br/>
                                            *Datos Generales Comercio Exterior
                                            <div style="border-style: dashed; border-color: rgb(244,129,16); padding: 5px; margin-bottom: 7px;">
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <h:outputText value="*Tipo de operación"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Motivo traslado"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Clave Pedimento"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Certificado origen"/>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.tipoOperacionCE}" readonly="true" />
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:selectOneMenu style="width: 200px !important" value="#{cfdi33V.motivoTrasladoCE}" autoWidth="false">
                                                            <f:selectItem itemValue="" itemLabel="Seleccionar" ></f:selectItem>
                                                            <f:selectItem itemValue="01" itemLabel="01-Envío de mercancias facturadas con anterioridad " ></f:selectItem>  
                                                            <f:selectItem itemValue="02" itemLabel="02-Reubicación de mercancías propias" ></f:selectItem>  
                                                            <f:selectItem itemValue="03" itemLabel="03-Envío de mercancías objeto de contrato de consignación" ></f:selectItem>  
                                                            <f:selectItem itemValue="04" itemLabel="04-Envío de mercancías para posterior enajenación" ></f:selectItem>  
                                                            <f:selectItem itemValue="05" itemLabel="05-Envío de mercancías propiedad de terceros" ></f:selectItem>  
                                                            <f:selectItem itemValue="99" itemLabel="99-Otros" ></f:selectItem>  
                                                            <f:ajax event="change" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('1')}"/>
                                                        </p:selectOneMenu>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:selectOneMenu style="width: 200px !important" value="#{cfdi33V.clavePedimentoCE}" autoWidth="false">
                                                            <f:selectItem itemValue="" itemLabel="Seleccionar" ></f:selectItem>
                                                            <f:selectItem itemValue="A1" itemLabel="A1-IMPORTACION O EXPORTACION DEFINITIVA" ></f:selectItem>                                                          
                                                            <f:ajax event="change" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('2')}"/>
                                                        </p:selectOneMenu>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:selectOneMenu style="width: 200px !important" value="#{cfdi33V.certificadoOrigenCE}" autoWidth="false">
                                                            <f:selectItem itemValue="" itemLabel="Seleccionar" ></f:selectItem>
                                                            <f:selectItem itemValue="0" itemLabel="0-No" ></f:selectItem>
                                                            <f:selectItem itemValue="1" itemLabel="1-Funge como certificado de origen." ></f:selectItem>
                                                            <f:ajax event="change" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('3')}"/>
                                                        </p:selectOneMenu>
                                                    </div>
                                                </div>
                                                <br/>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <h:outputText value="Num Certificado Org"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Num Expor Confiab"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Incoterm"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Subdivisión"/>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.numCertificadoOrigenCE}" maxlength="40" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('4')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText  value="#{cfdi33V.numExportConfiabCE}" maxlength="50">
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('5')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:selectOneMenu style="width: 200px !important" value="#{cfdi33V.incotermCE}" autoWidth="false">
                                                            <f:selectItem itemValue="" itemLabel="Seleccionar" ></f:selectItem>
                                                            <f:selectItem itemValue="CFR" itemLabel="CFR-COSTE Y FLETE (PUERTO DE DESTINO CONVENIDO)" ></f:selectItem>
                                                            <f:selectItem itemValue="CIF" itemLabel="CIF-COSTE, SEGURO Y FLETE (PUERTO DE DESTINO CONVENIDO)" ></f:selectItem>
                                                            <f:selectItem itemValue="CPT" itemLabel="CPT-TRANSPORTE PAGADO HASTA (EL LUGAR DE DESTINO CONVENIDO)" ></f:selectItem>
                                                            <f:selectItem itemValue="CIP" itemLabel="CIP-TRANSPORTE Y SEGURO PAGADOS HASTA (LUGAR DE DESTINO CONVENIDO)" ></f:selectItem>
                                                            <f:selectItem itemValue="DAF" itemLabel="DAF-ENTREGADA EN FRONTERA (LUGAR CONVENIDO)" ></f:selectItem>
                                                            <f:selectItem itemValue="DAP" itemLabel="DAP-ENTREGADA EN LUGAR" ></f:selectItem>
                                                            <f:selectItem itemValue="DAT" itemLabel="DAT-ENTREGADA EN TERMINAL" ></f:selectItem>
                                                            <f:selectItem itemValue="DES" itemLabel="DES-ENTREGADA SOBRE BUQUE (PUERTO DE DESTINO CONVENIDO)" ></f:selectItem>
                                                            <f:selectItem itemValue="DEQ" itemLabel="DEQ-ENTREGADA EN MUELLE (PUERTO DE DESTINO CONVENIDO)" ></f:selectItem>
                                                            <f:selectItem itemValue="DDU" itemLabel="DDU-ENTREGADA DERECHOS NO PAGADOS (LUGAR DE DESTINO CONVENIDO)" ></f:selectItem>
                                                            <f:selectItem itemValue="DDP" itemLabel="DDP-ENTREGADA DERECHOS PAGADOS (LUGAR DE DESTINO CONVENIDO)" ></f:selectItem>
                                                            <f:selectItem itemValue="EXW" itemLabel="EXW-EN FABRICA (LUGAR CONVENIDO)" ></f:selectItem>
                                                            <f:selectItem itemValue="FCA" itemLabel="FCA-FRANCO TRANSPORTISTA (LUGAR DESIGNADO)" ></f:selectItem>
                                                            <f:selectItem itemValue="FAS" itemLabel="FAS-FRANCO AL COSTADO DEL BUQUE (PUERTO DE CARGA CONVENIDO)" ></f:selectItem>
                                                            <f:selectItem itemValue="FOB" itemLabel="FOB-FRANCO A BORDO (PUERTO DE CARGA CONVENIDO)" ></f:selectItem>
                                                            <f:ajax event="change" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('6')}"/>
                                                        </p:selectOneMenu>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:selectOneMenu style="width: 200px !important" value="#{cfdi33V.subdivisionCE}" autoWidth="false">
                                                            <f:selectItem itemValue="" itemLabel="Seleccionar" ></f:selectItem>
                                                            <f:selectItem itemValue="0" itemLabel="0-NO TIENE" ></f:selectItem>
                                                            <f:selectItem itemValue="1" itemLabel="1-SI TIENE" ></f:selectItem>
                                                            <f:ajax event="change" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('7')}"/>
                                                        </p:selectOneMenu>
                                                    </div>
                                                </div>
                                                <br/>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <h:outputText value="Observaciones"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Tipo cambio USD"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Total USD"/>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.observacionesCE}" maxlength="300" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('8')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.tipoCambioUSDCE}"  >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('9')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.totalUSDCE}"  >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('10')}"/>
                                                        </p:inputText>
                                                    </div>
                                                </div>
                                            </div>
                                            <br/>
                                            *Emisor
                                            <div style="border-style: dashed; border-color: rgb(244,129,16); padding: 5px; margin-bottom: 7px;">
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <h:outputText value="CURP"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="*Calle"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Num Exterior"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Num Interior"/>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.curpCE}" maxlength="18" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('11')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.calleECE}" maxlength="100" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('12')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.numExtECE}" maxlength="55">
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('13')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.numIntECE}" maxlength="55" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('14')}"/>
                                                        </p:inputText>
                                                    </div>
                                                </div>
                                                <br/>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <h:outputText value="Colonia"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Localidad"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Referencia"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Municipio"/>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.coloniaECE}" maxlength="120" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('15')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.localidadECE}" maxlength="120" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('16')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.referenciaECE}" maxlength="250">
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('17')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.municipioECE}" maxlength="120" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('18')}"/>
                                                        </p:inputText>
                                                    </div>
                                                </div>
                                                <br/>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <h:outputText value="*Estado"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="*Pais"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="*Codigo Postal"/>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.estadoECE}" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('19')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.paisECE}"  >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('20')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.cpECE}" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('21')}"/>
                                                        </p:inputText>
                                                    </div>
                                                </div>
                                                <br/>
                                            </div>
                                            <br/>
                                            *Receptor
                                            <div style="border-style: dashed; border-color: rgb(244,129,16); padding: 5px; margin-bottom: 7px;">
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <h:outputText value="NumRegIdTrib"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="*Calle"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Num Exterior"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Num Interior"/>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.numRegIdTribECE}" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('22')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.calleRCE}"  >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('23')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.numExtRCE}" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('24')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.numIntRCE}" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('25')}"/>
                                                        </p:inputText>
                                                    </div>
                                                </div>
                                                <br/>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <h:outputText value="Colonia"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Localidad"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Referencia"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="Municipio"/>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.coloniaRCE}" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('26')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.localidadRCE}">
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('27')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.referenciaRCE}" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('28')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.municipioRCE}">
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('29')}"/>
                                                        </p:inputText>
                                                    </div>
                                                </div>
                                                <br/>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <h:outputText value="*Estado"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="*Pais"/>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <h:outputText value="*Codigo Postal"/>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.estadoRCE}" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('30')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.paisRCE}" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('31')}"/>
                                                        </p:inputText>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <p:inputText value="#{cfdi33V.cpRCE}" >
                                                            <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('32')}"/>
                                                        </p:inputText>
                                                    </div>
                                                </div>
                                                <br/>
                                            </div>
                                            <br/>
                                            Propietario
                                            <div style="border-style: dashed; border-color: rgb(244,129,16); padding: 5px; margin-bottom: 7px;">
                                                <p:outputPanel id="propietarioP">
                                                    <p:outputPanel id="PPT">
                                                        <div class="row">
                                                            <div class="col-md-3">
                                                                <h:outputText value="*NumRegIdTrib"/>
                                                            </div>
                                                            <div class="col-md-3">
                                                                <h:outputText value="*Recidencia Fiscal"/>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-3">
                                                                <p:inputText value="#{cfdi33V.numRegIdTribPCE}">
                                                                    <f:ajax render=":formcfdi33:propietarioP" listener="#{cfdi33V.mayusDatos('33')}" event="blur" />
                                                                </p:inputText>
                                                            </div>
                                                            <div class="col-md-3">
                                                                <p:inputText value="#{cfdi33V.recidenciaFiscalPCE}" > 
                                                                    <f:ajax render=":formcfdi33:propietarioP" listener="#{cfdi33V.mayusDatos('34')}"  event="blur" />
                                                                </p:inputText>
                                                            </div>
                                                            <div class="col-md-3">                                                    
                                                                <h:commandButton value="agregar">
                                                                    <f:ajax render=":formcfdi33:propietarioP" listener="#{cfdi33V.agregarPropietario}" />
                                                                </h:commandButton>
                                                            </div>
                                                        </div>
                                                        <br/>
                                                        <p:outputPanel id="tablePropietario">
                                                            <p:dataTable value="#{cfdi33V.propietario}" var="p" rendered="#{cfdi33V.tablaPropietarios}">
                                                                <f:facet name="header">
                                                                    <h:outputText value="Lista Propietarios"/>
                                                                </f:facet>
                                                                <p:column headerText="NuRegIdTrib">
                                                                    <h:outputText value="#{p.numRegIdTrib}"/>
                                                                </p:column>
                                                                <p:column headerText="Recidencia Fiscal">
                                                                    <h:outputText value="#{p.recidenciaFiscal}"/>
                                                                </p:column>
                                                                <p:column headerText="">
                                                                    <h:commandButton value="Eliminar">
                                                                        <p:ajax update="formcfdi33:propietarioP" listener="#{cfdi33V.eliminarPropietario(p)}"/>
                                                                    </h:commandButton>
                                                                </p:column>
                                                            </p:dataTable>
                                                        </p:outputPanel>     
                                                    </p:outputPanel>
                                                </p:outputPanel>
                                                <br/>
                                            </div>
                                            <br/>
                                            Destinatario
                                            <div style="border-style: dashed; border-color: rgb(244,129,16); padding: 5px; margin-bottom: 7px;">
                                                <p:outputPanel id="destinatarios">
                                                    <div class="row">
                                                        <div class="col-md-3">
                                                            <h:outputText value="NumRegIdTrib"/>
                                                        </div>
                                                        <div class="col-md-3">
                                                            <h:outputText value="Nombre"/>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-3">
                                                            <p:inputText value="#{cfdi33V.numRegIdTribDCE}" >
                                                                <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('35')}"/>
                                                            </p:inputText>
                                                        </div>
                                                        <div class="col-md-3">
                                                            <p:inputText value="#{cfdi33V.nombreDCE}" >
                                                                <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('36')}"/>
                                                            </p:inputText>
                                                        </div>
                                                    </div>
                                                    <br/>
                                                    <p:outputPanel id="desDirecciones">
                                                        Domicilios
                                                        <div style="border-style: dashed; border-color: rgb(244,129,16); padding: 5px; margin-bottom: 7px;">
                                                            <div class="row">                                                        
                                                                <div class="col-md-3">
                                                                    <h:outputText value="*Calle"/>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <h:outputText value="Num Exterior"/>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <h:outputText value="Num Interior"/>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <h:outputText value="Colonia"/>
                                                                </div>
                                                            </div>
                                                            <div class="row">                                                        
                                                                <div class="col-md-3">
                                                                    <p:inputText value="#{cfdi33V.calleDCE}" >
                                                                        <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('37')}"/>
                                                                    </p:inputText>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <p:inputText value="#{cfdi33V.numExtDCE}" >
                                                                        <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('38')}"/>
                                                                    </p:inputText>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <p:inputText value="#{cfdi33V.numIntDCE}" >
                                                                        <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('39')}"/>
                                                                    </p:inputText>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <p:inputText value="#{cfdi33V.coloniaDCE}" >
                                                                        <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('40')}"/>
                                                                    </p:inputText>
                                                                </div>
                                                            </div>
                                                            <br/>
                                                            <div class="row">                                                        
                                                                <div class="col-md-3">
                                                                    <h:outputText value="Localidad"/>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <h:outputText value="Referencia"/>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <h:outputText value="Municipio"/>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <h:outputText value="*Estado"/>
                                                                </div>
                                                            </div>
                                                            <div class="row">                                                        
                                                                <div class="col-md-3">
                                                                    <p:inputText value="#{cfdi33V.localidadDCE}" >
                                                                        <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('41')}"/>
                                                                    </p:inputText>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <p:inputText value="#{cfdi33V.referenciaDCE}" >
                                                                        <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('42')}"/>
                                                                    </p:inputText>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <p:inputText value="#{cfdi33V.municipioDCE}" >
                                                                        <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('43')}"/>
                                                                    </p:inputText>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <p:inputText value="#{cfdi33V.estadoDCE}" >
                                                                        <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('44')}"/>
                                                                    </p:inputText>
                                                                </div>
                                                            </div>
                                                            <br/>
                                                            <div class="row">                                                        
                                                                <div class="col-md-3">
                                                                    <h:outputText value="*Pais"/>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <h:outputText value="*Codigo Postal"/>
                                                                </div>
                                                            </div>
                                                            <div class="row">                                                        
                                                                <div class="col-md-3">
                                                                    <p:inputText value="#{cfdi33V.paisDCE}" >
                                                                        <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('45')}"/>
                                                                    </p:inputText>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <p:inputText value="#{cfdi33V.cpDCE}" >
                                                                        <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('46')}"/>
                                                                    </p:inputText>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <h:commandButton value="Agregar domicilio">
                                                                        <p:ajax update="formcfdi33:desDirecciones" listener="#{cfdi33V.agregarDomicilioDest}" />
                                                                    </h:commandButton>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <br/>
                                                        <p:outputPanel id="doiciliosTable">
                                                            <p:dataTable value="#{cfdi33V.destinatario.domicilio}" var="d" rendered="#{cfdi33V.tablaDomicilios}">
                                                                <f:facet name="header">
                                                                    <h:outputText value="Lista domicilio"/>
                                                                </f:facet>
                                                                <p:column headerText="Calle">
                                                                    <h:outputText value="#{d.calle}"/>
                                                                </p:column>
                                                                <p:column headerText="Pais">
                                                                    <h:outputText value="#{d.pais}"/>
                                                                </p:column>
                                                                <p:column headerText="Estado">
                                                                    <h:outputText value="#{d.estado}"/>
                                                                </p:column>
                                                                <p:column headerText="C.P.">
                                                                    <h:outputText value="#{d.cp}"/>
                                                                </p:column>
                                                                <p:column headerText="">
                                                                    <h:commandButton value="Eliminar" >
                                                                        <p:ajax update="formcfdi33:desDirecciones" listener="#{cfdi33V.eliminarDomicilioDest(d)}"/>
                                                                    </h:commandButton>
                                                                </p:column>
                                                            </p:dataTable>
                                                        </p:outputPanel>
                                                    </p:outputPanel>
                                                    <br/>
                                                    <div class="row">
                                                        <div class="col-md-12 text-right">
                                                            <h:commandButton value="Agregar destinatario">
                                                                <p:ajax update="formcfdi33:destinatarios" listener="#{cfdi33V.agregarDestinatario}" />
                                                            </h:commandButton>
                                                        </div>
                                                    </div>
                                                    <br/>
                                                    <p:outputPanel id="destinatarioTable">
                                                        <p:dataTable value="#{cfdi33V.compComExt.destinatarios}" var="d" rendered="#{cfdi33V.tablaDestinatarios}">
                                                            <f:facet name="header">
                                                                <h:outputText value="Lista destinatarios"/>
                                                            </f:facet>
                                                            <p:column headerText="NuRegIdTrib">
                                                                <h:outputText value="#{d.numRegIdTrib}"/>
                                                            </p:column>
                                                            <p:column headerText="Nombre">
                                                                <h:outputText value="#{d.nombre}"/>
                                                            </p:column>
                                                            <p:column headerText="">
                                                                <h:commandButton value="Eliminar">
                                                                    <p:ajax update="formcfdi33:destinatarios" listener="#{cfdi33V.eliminarDestinatario(d)}"/>
                                                                </h:commandButton>
                                                            </p:column>
                                                        </p:dataTable>
                                                    </p:outputPanel>
                                                </p:outputPanel>
                                            </div>
                                            <br/>
                                            *Mercancia
                                            <div style="border-style: dashed; border-color: rgb(244,129,16); padding: 5px; margin-bottom: 7px;">
                                                <p:outputPanel id="mercancias">
                                                    <div class="row">                                                        
                                                        <div class="col-md-4">
                                                            <h:outputText value="*NoIdentificación"/>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <h:outputText value="Fracción arancelaria"/>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <h:outputText value="Cantidad aduana"/>
                                                        </div>
                                                    </div>
                                                    <div class="row">                                                        
                                                        <div class="col-md-4">
                                                            <p:inputText value="#{cfdi33V.noIdentificacionCE}" >
                                                                <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('47')}"/>
                                                            </p:inputText>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <p:inputText value="#{cfdi33V.fraccionArancelariaCE}" >
                                                                <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('48')}"/>
                                                            </p:inputText>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <p:inputText value="#{cfdi33V.cantidadAduanaCE}" >
                                                                <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('49')}"/>
                                                            </p:inputText>
                                                        </div>
                                                    </div>
                                                    <br/>
                                                    <div class="row">                                                        
                                                        <div class="col-md-4">
                                                            <h:outputText value="Unidad aduana"/>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <h:outputText value="Valor unitario aduana"/>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <h:outputText value="*Valor dolares"/>
                                                        </div>
                                                    </div>
                                                    <div class="row">                                                        
                                                        <div class="col-md-4">
                                                            <p:inputText value="#{cfdi33V.unidadAdunaCE}" >
                                                                <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('50')}"/>
                                                            </p:inputText>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <p:inputText value="#{cfdi33V.valorUnitarioAduanaCE}" >
                                                                <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('51')}"/>
                                                            </p:inputText>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <p:inputText value="#{cfdi33V.valorUnitarioAduanaCE}" >
                                                                <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('52')}"/>
                                                            </p:inputText>
                                                        </div>
                                                    </div>
                                                    <br/>
                                                    <p:outputPanel id="mercDescrip">
                                                        Descripciones Especificas
                                                        <div style="border-style: dashed; border-color: rgb(244,129,16); padding: 5px; margin-bottom: 7px;">
                                                            <div class="row">
                                                                <div class="col-md-3">
                                                                    <h:outputText value="*Marca"/>
                                                                </div> 
                                                                <div class="col-md-3">
                                                                    <h:outputText value="Modelo"/>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <h:outputText value="SubModelo"/>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <h:outputText value="Numero Serie"/>
                                                                </div>
                                                            </div>
                                                            <div class="row">                                                        
                                                                <div class="col-md-3">
                                                                    <p:inputText value="#{cfdi33V.marcaCE}" >
                                                                        <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('53')}"/>
                                                                    </p:inputText>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <p:inputText value="#{cfdi33V.modeloCE}" >
                                                                        <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('54')}"/>
                                                                    </p:inputText>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <p:inputText value="#{cfdi33V.submodeloCE}">
                                                                        <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('55')}"/>
                                                                    </p:inputText>
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <p:inputText value="#{cfdi33V.numSerieCE}" >
                                                                        <f:ajax event="blur" render=":formcfdi33:datosGenerales" listener="#{cfdi33V.mayusDatos('56')}"/>
                                                                    </p:inputText>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-md-12 text-right">
                                                                    <h:commandButton value="Agregar Descripción">
                                                                        <p:ajax update="formcfdi33:mercDescrip" listener="#{cfdi33V.agregarDescEsp}"/>
                                                                    </h:commandButton>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <br/>
                                                        <p:outputPanel id="descripcionesTable">
                                                            <p:dataTable var="d" value="#{cfdi33V.mercancia.descEspec}" rendered="#{cfdi33V.tablaDescripciones}">
                                                                <f:facet name="header">
                                                                    <h:outputText value="Lista Descripciones"/>
                                                                </f:facet>
                                                                <p:column headerText="Marca">
                                                                    <h:outputText value="#{d.marca}"/>
                                                                </p:column>
                                                                <p:column headerText="Modelo">
                                                                    <h:outputText value="#{d.modelo}"/>
                                                                </p:column>
                                                                <p:column headerText="SubModelo">
                                                                    <h:outputText value="#{d.subModelo}"/>
                                                                </p:column>
                                                                <p:column headerText="Serie">
                                                                    <h:outputText value="#{d.numeroSerie}"/>
                                                                </p:column>
                                                                <p:column headerText="">
                                                                    <h:commandButton value="Eliminar">
                                                                        <p:ajax update="formcfdi33:mercDescrip" listener="#{cfdi33V.eliminarDescEsp(d)}"/>
                                                                    </h:commandButton>
                                                                </p:column>
                                                            </p:dataTable>
                                                        </p:outputPanel>
                                                    </p:outputPanel>
                                                    <div class="row">
                                                        <div class="col-md-12 text-right">
                                                            <h:commandButton value="Agregar Mercancia">
                                                                <p:ajax update="formcfdi33:mercancias" listener="#{cfdi33V.agregarMercancia}"/>
                                                            </h:commandButton>
                                                        </div>
                                                    </div>
                                                    <br/>
                                                    <p:outputPanel id="mercanciasTable">
                                                        <p:dataTable value="#{cfdi33V.compComExt.mercancias}" var="m" rendered="#{cfdi33V.tablaMercancias}">
                                                            <f:facet name="header">
                                                                <h:outputText value="Lista Mercancias"/>
                                                            </f:facet>
                                                            <p:column headerText="NoIdentificacón">
                                                                <h:outputText value="#{m.noIdentificacion}"/>
                                                            </p:column>
                                                            <p:column headerText="Valor dolares">
                                                                <h:outputText value="#{m.valorDolares}"/>
                                                            </p:column>
                                                            <p:column headerText="">
                                                                <h:commandButton value="Eliminar">
                                                                    <p:ajax update="formcfdi33:mercancias" listener="#{cfdi33V.eliminarMercancia(m)}"/>
                                                                </h:commandButton>
                                                            </p:column>
                                                        </p:dataTable>
                                                    </p:outputPanel>
                                                </p:outputPanel>
                                            </div>
                                        </p:outputPanel>
                                    </div>
                                </div>
                            </div>

                        </p:outputPanel>

                        <div class="card">
                            <div class="card-header" id="total">
                                <h2 class="mb-0">
                                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#totalM" aria-expanded="false" aria-controls="totalM">
                                        Total
                                    </button>
                                </h2>
                            </div>
                            <div id="totalM" class="collapse" aria-labelledby="total" data-parent="#cfdi33">
                                <div class="card-body">
                                    <p:outputPanel id="totalPanel">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <h:outputText value="Importe con letra:" />
                                            </div>                                            
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <h:outputText value="#{cfdi33V.totalFacturaEnLetras}" />
                                            </div>
                                        </div>
                                        <br/>
                                        <div class="row">
                                            <div class="col-md-8">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <h:outputText value="Observaciones" />
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <p:inputTextarea rows="6" value="#{cfdi33V.observaciones}" style="width: 100% !important;">
                                                            <p:ajax  update="formcfdi33:totalPanel" event="blur" listener="#{cfdi33V.observacionesSet}"/>
                                                        </p:inputTextarea>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="*Subtotal:" />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:outputText value="#{cfdi33V.subTotal}">
                                                            <f:convertNumber currencySymbol="$" groupingUsed="true"  maxFractionDigits="2" type="currency" locale="es_MX" />
                                                        </h:outputText>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="Descuento total:" />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:outputText value="#{cfdi33V.descuentoTotal}">
                                                            <f:convertNumber currencySymbol="$" groupingUsed="true"  maxFractionDigits="2" type="currency" locale="es_MX" />
                                                        </h:outputText>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="Trasladados:" />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:outputText value="#{cfdi33V.totalTrasl}">
                                                            <f:convertNumber currencySymbol="$" groupingUsed="true"  maxFractionDigits="2" type="currency" locale="es_MX" />
                                                        </h:outputText>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="Retenidos:" />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:outputText value="#{cfdi33V.totalReten}">
                                                            <f:convertNumber currencySymbol="$" groupingUsed="true"  maxFractionDigits="2" type="currency" locale="es_MX" />
                                                        </h:outputText>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6 text-right">
                                                        <h:outputText value="*Total:" />
                                                    </div>
                                                    <div class="col-md-6 text-left">
                                                        <h:outputText value="#{cfdi33V.total}">
                                                            <f:convertNumber currencySymbol="$" groupingUsed="true"  maxFractionDigits="2" type="currency" locale="es_MX" />
                                                        </h:outputText>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>                                        
                                        <div class="row">
                                            <div class="col-md-8"></div>
                                            <div class="col-md-4 text-right">

                                            </div>
                                        </div>
                                    </p:outputPanel>                                    
                                </div> 
                            </div>
                        </div>
                    </div>                    
                </h:form>
                <h:form id="botones" style="text-align: right !important;">
                    <p:row>
                        <p:column rendered="#{cfdi33V.btnsVE}">
                            <p:dialog modal="true" widgetVar="statusDialog" header="Status" draggable="false" closable="false" resizable="false">
                                <p:graphicImage value="images/loading.gif" />
                            </p:dialog>
                            <h:commandButton onclick="PrimeFaces.monitorDownload(start, stop);"  actionListener="#{cfdi33V.validarCamposCFDI(true)}" value="Vista Previa">
                                <p:fileDownload value="#{cfdi33V.filePdfVP}" />
                            </h:commandButton>
                            <h:commandButton onclick="PrimeFaces.monitorDownload(start, stop);"  actionListener="#{cfdi33V.validarCamposCFDI(false)}" value="Emitir CFDI">
                                <p:fileDownload value="#{cfdi33V.filePdfVP}" />
                            </h:commandButton>
                        </p:column>
                    </p:row>
                    <br/>
                    <p:row>
                        <p:column>
                            <p:inputTextarea cols="300"  readonly="true" value="#{cfdi33V.errorTimbrado}" rendered="#{cfdi33V.errorBol}"  scrollHeight="150" style="width: 100% !important"/>
                        </p:column>
                    </p:row>
                </h:form>
            </ui:define>
        </ui:composition>
    </h:body>
</html>



